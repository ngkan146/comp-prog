<!DOCTYPE html>
<html lang="en-US"> <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Rotating calipers - Ngkcpl</title> <link rel="shortcut icon" href="/cpl/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/cpl/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/cpl/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/cpl/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Rotating calipers | Ngkcpl</title> <meta name="generator" content="Jekyll v4.1.1"> <meta property="og:title" content="Rotating calipers"> <meta property="og:locale" content="en_US"> <meta name="description" content="Competitive programming library"> <meta property="og:description" content="Competitive programming library"> <link rel="canonical" href="https://ngkan.github.io/cpl/geometry/rotating-calipers.html"> <meta property="og:url" content="https://ngkan.github.io/cpl/geometry/rotating-calipers.html"> <meta property="og:site_name" content="Ngkcpl"> <meta name="twitter:card" content="summary"> <meta property="twitter:title" content="Rotating calipers"> <script type="application/ld+json"> {"description":"Competitive programming library","url":"https://ngkan.github.io/cpl/geometry/rotating-calipers.html","@type":"WebPage","headline":"Rotating calipers","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link href="/cpl/assets/css/vs_custom.css" rel="stylesheet"> <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewbox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://ngkan.github.io/cpl/" class="site-title lh-tight"> Ngkcpl </a> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list">
<li class="nav-list-item"><a href="https://ngkan.github.io/cpl/" class="nav-list-link">Home</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/data-structure/" class="nav-list-link">Data Structure</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/data-structure/segment-tree.html" class="nav-list-link">Segment Tree</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/data-structure/treap.html" class="nav-list-link">Treap</a></li>
</ul>
</li>
<li class="nav-list-item active">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/geometry/" class="nav-list-link">Geometry</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/geometry/point.html" class="nav-list-link">Point</a></li>
<li class="nav-list-item active"><a href="https://ngkan.github.io/cpl/geometry/rotating-calipers.html" class="nav-list-link active">Rotating calipers</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/math/" class="nav-list-link">Math</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/math/bin-pow.html" class="nav-list-link">Binary exponential</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/math/tonelli-shanks.html" class="nav-list-link">Tonelli Shanks</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/misc/" class="nav-list-link">Misc</a><ul class="nav-list "><li class="nav-list-item "><a href="https://ngkan.github.io/cpl/misc/left-right-algo.html" class="nav-list-link">Thuật toán Left-Right</a></li></ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/string/" class="nav-list-link">String</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/string/KMP.html" class="nav-list-link">Knuth - Morris - Pratt</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/string/suffix-array.html" class="nav-list-link">Suffix Array</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/train/" class="nav-list-link">Training resources</a><ul class="nav-list "><li class="nav-list-item "><a href="https://ngkan.github.io/cpl/train/useful-links.html" class="nav-list-link">Useful links</a></li></ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander"><svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://ngkan.github.io/cpl/vnoi/" class="nav-list-link">VNOI</a><ul class="nav-list ">
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/vnoi/tst2014.html" class="nav-list-link">TST 2014</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/vnoi/tst2017.html" class="nav-list-link">TST 2017</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/vnoi/tst2018.html" class="nav-list-link">TST 2018</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/vnoi/tst2019.html" class="nav-list-link">TST 2019</a></li>
<li class="nav-list-item "><a href="https://ngkan.github.io/cpl/vnoi/tst2020.html" class="nav-list-link">TST 2020</a></li>
</ul>
</li>
</ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Ngkcpl" aria-label="Search Ngkcpl" autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://ngkan.github.io/cpl/geometry/">Geometry</a></li> <li class="breadcrumb-nav-list-item"><span>Rotating calipers</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="rotating-calipers"> <a href="#rotating-calipers" class="anchor-heading" aria-labelledby="rotating-calipers"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rotating calipers </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#thu%E1%BA%ADt-to%C3%A1n" id="markdown-toc-thuật-toán">Thuật toán</a></li> <li>
<a href="#%E1%BB%A9ng-d%E1%BB%A5ng" id="markdown-toc-ứng-dụng">Ứng dụng</a> <ol> <li><a href="#t%C3%ACm-kho%E1%BA%A3ng-c%C3%A1ch-l%E1%BB%9Bn-nh%E1%BA%A5t-gi%E1%BB%AFa-hai-%C4%91i%E1%BB%83m-trong-m%E1%BB%99t-t%E1%BA%ADp-%C4%91i%E1%BB%83m-%C4%91%C3%A3-cho" id="markdown-toc-tìm-khoảng-cách-lớn-nhất-giữa-hai-điểm-trong-một-tập-điểm-đã-cho">Tìm khoảng cách lớn nhất giữa hai điểm trong một tập điểm đã cho.</a></li> <li><a href="#t%C3%ACm-chi%E1%BB%81u-r%E1%BB%99ng-nh%E1%BB%8F-nh%E1%BA%A5t-c%E1%BB%A7a-m%E1%BB%99t-%C4%91a-gi%C3%A1c-l%E1%BB%93i" id="markdown-toc-tìm-chiều-rộng-nhỏ-nhất-của-một-đa-giác-lồi">Tìm chiều rộng nhỏ nhất của một đa giác lồi</a></li> <li><a href="#t%C3%ACm-h%C3%ACnh-ch%E1%BB%AF-nh%E1%BA%ADt-c%C3%B3-chu-vi-nh%E1%BB%8F-nh%E1%BA%A5t-bao-m%E1%BB%99t-%C4%91a-gi%C3%A1c-l%E1%BB%93i" id="markdown-toc-tìm-hình-chữ-nhật-có-chu-vi-nhỏ-nhất-bao-một-đa-giác-lồi">Tìm hình chữ nhật có chu vi nhỏ nhất bao một đa giác lồi</a></li> </ol> </li> </ol>
<hr> <h2 id="thuật-toán"> <a href="#thu%E1%BA%ADt-to%C3%A1n" class="anchor-heading" aria-labelledby="thuật-toán"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Thuật toán </h2> <p>Tên của thuật toán đến từ ý tưởng của chính nó: xoay thước cặp xung quanh đa giác lồi. Mỗi khi một cạnh của thước trùng với cạnh của đa giác, 2 điểm của đỉnh nằm trên 2 cạnh sẽ tạo thành một antipodal pair. Sau khi xoay một vòng, ta sẽ thu được tất cả antipodal pairs của đa giác (một antipodals pair của đa giác lồi là một cặp đỉnh của đa giác sao cho tồn tại hai đường thẳng song song đi qua chúng và không cắt đa giác).</p> <p>Giả sử các đỉnh của đa giác đã được xếp theo thứ tự ngược chiều kim đồng hồ và được chứa trong mảng $p$. Xuất phát từ đỉnh $A = 0$, trước hết ta tìm đỉnh $B$ có thứ tự lớn nhất mà góc tạo bởi vector $\overrightarrow{P_A P_{A+1}}$ và vector $\overrightarrow{P_{B-1}P_B}$ theo chiều ngược kim đồng hồ không vượt quá $180^{\circ}$, hay tích chéo giữa hai vector mang giá trị dương (*). $\overrightarrow{P_B}$ cùng với $\overrightarrow{P_A}$ chắc chắn tạo thành một antipodal pair. Tiếp theo, để tìm kết quả cho $A+1$, ta chỉ việc tăng $B$ đến $B’$ lớn nhất có thể mà vẫn giữ được tính chất (*), khi đó $\overrightarrow{P_{A+1}}$ và $\overrightarrow{P_B}$ cũng là một antipodal pair… Độ phức tạp của thuật toán là $O(n)$.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int a = 0, b = 0;
for (;a&lt;n;a++){
	while(góc của 2 vector theo chiều ngược kim đồng hồ &lt; 180 độ) 
		b = (b+1)%n;
	// a và b tạo thành một antipodal pair
}
</code></pre></div></div> <h2 id="ứng-dụng"> <a href="#%E1%BB%A9ng-d%E1%BB%A5ng" class="anchor-heading" aria-labelledby="ứng-dụng"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ứng dụng </h2> <h3 id="tìm-khoảng-cách-lớn-nhất-giữa-hai-điểm-trong-một-tập-điểm-đã-cho"> <a href="#t%C3%ACm-kho%E1%BA%A3ng-c%C3%A1ch-l%E1%BB%9Bn-nh%E1%BA%A5t-gi%E1%BB%AFa-hai-%C4%91i%E1%BB%83m-trong-m%E1%BB%99t-t%E1%BA%ADp-%C4%91i%E1%BB%83m-%C4%91%C3%A3-cho" class="anchor-heading" aria-labelledby="tìm-khoảng-cách-lớn-nhất-giữa-hai-điểm-trong-một-tập-điểm-đã-cho"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tìm khoảng cách lớn nhất giữa hai điểm trong một tập điểm đã cho. </h3> <p>Ta có thể thấy được hai điểm tạo khoảng cách lớn nhất trong tập điểm chắc chắn thuộc bao lồi của tập điểm đã cho.</p> <blockquote> <p>Chứng minh</p> <blockquote> <p>Giả sử tồn tại hai điểm có khoảng cách lớn nhất mà có ít nhất một điểm không thuộc bao lồi. Gọi điểm đó là $A$, điểm còn lại sẽ là $B$; tia $\overrightarrow{BA}$ chắc chắn cắt bao lồi tại điểm $B’$ của cạnh $CD$. Khi đó $|AB| \leq |AB’| \leq max(|AC|, |AD|)$, điều này là vô lý vì $|AB|$ là khoảng cách lớn nhất trong tập điểm.</p> </blockquote> </blockquote> <blockquote> <blockquote> <p><img src="/cpl/assets/posts/geometry/rotating-calipers/figure1.png" alt="Figure 1"></p> </blockquote> </blockquote> <p>Ngoài ra, hai điểm đó còn tạo thành một antipodal pair (có thể chỉ ra được một cặp đường thẳng đi qua 2 điểm này và không cắt đa giác, đó là 2 đường thằng song song với nhau và vuông góc với đoạn thẳng nối hai điểm này). Từ đây, ta chỉ cần tính khoảng cách giữa hai điểm trong mọi antipodal pairs.</p> <h3 id="tìm-chiều-rộng-nhỏ-nhất-của-một-đa-giác-lồi"> <a href="#t%C3%ACm-chi%E1%BB%81u-r%E1%BB%99ng-nh%E1%BB%8F-nh%E1%BA%A5t-c%E1%BB%A7a-m%E1%BB%99t-%C4%91a-gi%C3%A1c-l%E1%BB%93i" class="anchor-heading" aria-labelledby="tìm-chiều-rộng-nhỏ-nhất-của-một-đa-giác-lồi"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tìm chiều rộng nhỏ nhất của một đa giác lồi </h3> <h3 id="tìm-hình-chữ-nhật-có-chu-vi-nhỏ-nhất-bao-một-đa-giác-lồi"> <a href="#t%C3%ACm-h%C3%ACnh-ch%E1%BB%AF-nh%E1%BA%ADt-c%C3%B3-chu-vi-nh%E1%BB%8F-nh%E1%BA%A5t-bao-m%E1%BB%99t-%C4%91a-gi%C3%A1c-l%E1%BB%93i" class="anchor-heading" aria-labelledby="tìm-hình-chữ-nhật-có-chu-vi-nhỏ-nhất-bao-một-đa-giác-lồi"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tìm hình chữ nhật có chu vi nhỏ nhất bao một đa giác lồi </h3> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
